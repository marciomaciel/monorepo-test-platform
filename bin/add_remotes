#!/usr/bin/env bash

## VARIABLES ##
REPOS="package-category ssh://git@52.166.71.39:7999/nhsc/nhs-core-nestle-module-category.git\n
package-email-logger ssh://git@52.166.71.39:7999/nhsc/nhs-core-nestle-module-email-logger.git\n
package-payment-notifier ssh://git@52.166.71.39:7999/nhsc/nhs-core-nestle-module-payment-notifier.git\n
package-sales-review ssh://git@52.166.71.39:7999/nhsc/nhs-core-nestle-module-sales-review.git\n
package-shipping-tracking ssh://git@52.166.71.39:7999/nhsc/nhs-core-nestle-module-shipping-tracking.git\n
package-password-validation ssh://git@52.166.71.39:7999/nhsc/nhs-core-nestle-module-password-validation.git\n
package-product-best-seller ssh://git@52.166.71.39:7999/nhsc/nhs-core-nestle-module-product-best-seller.git"

REPO_LENGTH=`echo -e ${REPOS} | wc -l`

REPO_ARRAY=(${REPOS})

## FUNCTIONS ##
function remote_exists() {
    arg_remote_name=$1
    FOUND=0
    for item_remote in `git remote`; do
      if [[ "${arg_remote_name}" == "${item_remote}" ]]
        then
          FOUND=1
      fi
    done
    echo ${FOUND}
}

COUNTER=0
while [[ ${COUNTER} -lt ${REPO_LENGTH} ]]; do
  REPO_NAME_INDEX=$((2*${COUNTER}))
  REPO_URL_INDEX=$((2*${COUNTER}+1))

  REPO_NAME=${REPO_ARRAY[$REPO_NAME_INDEX]}
  REPO_URL=${REPO_ARRAY[$REPO_URL_INDEX]}

  REPO_NAME=${REPO_NAME//\\n/}
  REPO_URL=${REPO_URL//\\n/}

  if [[ `remote_exists "$REPO_NAME"` == "0" ]]
    then
      git remote add ${REPO_NAME} ${REPO_URL}
      echo "[Remote added]: ${REPO_NAME} ${REPO_URL}"
    else
      echo "[Already added]: ${REPO_NAME} ${REPO_URL}"
  fi

  let COUNTER=COUNTER+1
done